var zIndex = 2;
var categoryList = ['cats', 'kittens', 'girls', 'sexy girl'];
var localization = {
    default: 'en',
    en: {
        title: 'Splashy - Unsplash photos as desktop & mobile wallpapers'
    },
    ru: {
        title: 'ky-ky'
    },
    de: {}
}

function changeBackground() {
    var e = new XMLHttpRequest;
    e.open("GET", "https://source.unsplash.com/" + screen.width + "x" + screen.height + "?" + categoryList[Math.floor(Math.random() * categoryList.length)]),
    e.responseType = "blob",
    e.send(),
    e.addEventListener("load", function () {
        var n = new FileReader; 
        n.readAsDataURL(e.response), 
        n.addEventListener("loadend", function () {
            $(".backgrounds").append($('<div class="background"></div>').css({
                "background-image": 'url("' + n.result + '"',
                "z-index": zIndex 
            })),
            1 != zIndex ? (setTimeout(function () {
                $(".background:last-child").addClass("is-visible")
            }, 1e3),
            setTimeout(function () {
                $(".background:not(:last-child)").remove()
            }, 2e3)) : (setTimeout(function () {
                $(".background:last-child").addClass("is-visible")
            }, 500), setTimeout(function () {
                $(".intro").remove() }, 2e3)), zIndex++ , setTimeout(changeBackground, 4e3) }) 
    }),
    e.addEventListener("error", function () {
        setTimeout(changeBackground, 500) 
    })
}
function disableScroll() {
    document.ontouchmove = function (e) {
        e.preventDefault()
    }
} 

function showContent() {    
    $(".loader").addClass("is-hidden"),
    $(".content").addClass("is-visible")
}

$(function () {
    setTimeout(changeBackground, 4e3),
    disableScroll()
}), $(window).on("load", showContent);

function updateText() {
    window.localization = $('.language').val()
    $( '.result' ).text( localizedMessage ).prop( 'title', i18n.localize( message ) );
}

$( document ).ready( function ( $ ) {
	'use strict';
	updateText();
	$( '.language' ).on( 'change keyup', updateText );
} );